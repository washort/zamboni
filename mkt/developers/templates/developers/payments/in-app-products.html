{% extends 'developers/base_impala.html' %}
{% from 'developers/includes/macros.html' import required %}

{% set title = _('In-App Products') %}
{% block title %}{{ hub_page_title(title, webapp) }}{% endblock %}

{% set can_edit = check_webapp_ownership(request, webapp) %}
{% block bodyclass %}
  {{ super() }}{% if not can_edit %} no-edit{% endif %}
{% endblock %}

{% block css_extra %}
    {{ css('mkt/in-app-products') }}
{% endblock %}

{% block js %}
    {{ js('mkt/in-app-products') }}
{% endblock %}

{% block content %}
  <header>
    {{ hub_breadcrumbs(webapp, items=[(webapp.get_dev_url('in_app_payments'), _('In-App Payments')), (None, title)]) }}
    <h1>{{ title }}</h1>
  </header>

  <section class="primary manage" role="main">
    <h2>{{ title }}</h2>
    <div id="buglink-notification" class="island notification-box">
      <p>
        {% trans doc_link='https://developer.mozilla.org/en-US/Marketplace/Monetization/In-app_payments_section/Introduction_In-app_Payments' %}
          This feature is under active development. Please refer to the <a target="_blank" href="{{ doc_link }}">documentation</a> for more information.
        {% endtrans %}
      </p>
      <p>
        {% trans bug_link='https://bugzilla.mozilla.org/enter_bug.cgi?product=Marketplace&component=Payments/Refunds' %}
          If you find a problem please <a target="_blank" href="{{ bug_link }}">report a bug</a>.
        {% endtrans %}
      </p>
    </div>
    <div id="in-app-products"
         class="devhub-form island{% if not products %} empty{% endif %}"
         data-list-url="{{ list_url }}"
         data-active-lang="{{ active_lang }}"
         data-detail-url-format="{{ detail_url }}">
      <table id="version-list">
        <thead>
          <tr>
            <th>{{ _('Icon') }}</th>
            <th>{{ _('Name') }}</th>
            <th>{{ _('Price Point') }}</th>
            <th>{{ _('Product ID') }}</th>
            <th>{{ _('Status') }}</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {% for product in products %}
            {% include "developers/payments/in-app-product-row.html" %}
          {% endfor %}
        </tbody>
      </table>
      <p class="listing-footer">
        <button id="add-in-app-product">{{ _('Add a product') }}</button>
      </p>
    </div>
    <script id="in-app-product-row-template" type="x-template">
      {% with product=new_product %}
        {% include "developers/payments/in-app-product-row.html" %}
      {% endwith %}
    </script>
  </section>

  {% include "developers/includes/addons_edit_nav.html" %}
{% endblock %}
